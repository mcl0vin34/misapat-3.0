System.register("chunks:///_virtual/main",["./SpineController.ts.ts","./SocketManager.ts"],(function(){return{setters:[null,null],execute:function(){}}}));

System.register("chunks:///_virtual/SocketManager.ts",["./rollupPluginModLoBabelHelpers.js","cc"],(function(e){var s,n,o,t,r,i,a,c,l,u,g,h;return{setters:[function(e){s=e.applyDecoratedDescriptor,n=e.inheritsLoose,o=e.initializerDefineProperty,t=e.assertThisInitialized},function(e){r=e.cclegacy,i=e._decorator,a=e.EditBox,c=e.Button,l=e.Label,u=e.ProgressBar,g=e.Color,h=e.Component}],execute:function(){var d,b,p,f,y,w,I,m,L,k,B,M,v,P,U;r._RF.push({},"a0c39VZ6j5NRrT6cxMHqDGB","SocketManager",void 0);var S=i.ccclass,V=i.property;e("SocketManager",(d=S("SocketManager"),b=V(a),p=V(c),f=V(l),y=V(u),w=V(l),I=V(l),d((k=s((L=function(e){function s(){for(var s,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return s=e.call.apply(e,[this].concat(r))||this,o(s,"userIdInput",k,t(s)),o(s,"connectButton",B,t(s)),o(s,"coinsLabel",M,t(s)),o(s,"energyProgressBar",v,t(s)),o(s,"energyValueLabel",P,t(s)),o(s,"messagesLabel",U,t(s)),s.socket=null,s.userId=null,s.maxEnergy=2e3,s}n(s,e);var r=s.prototype;return r.start=function(){console.log("Инициализация SocketManager..."),console.log("userIdInput:",this.userIdInput),console.log("connectButton:",this.connectButton),console.log("coinsLabel:",this.coinsLabel),console.log("energyProgressBar:",this.energyProgressBar),console.log("energyValueLabel:",this.energyValueLabel),console.log("messagesLabel:",this.messagesLabel),this.userIdInput&&this.connectButton&&this.coinsLabel&&this.energyProgressBar&&this.energyValueLabel&&this.messagesLabel?(this.connectButton.node.on("click",this.onConnect,this),this.showUserInfo(!1)):console.error("Не все свойства SocketManager назначены в редакторе.")},r.onDestroy=function(){this.socket&&this.socket.disconnect()},r.onConnect=function(){var e=this,s=this.userIdInput.string.trim(),n=parseInt(s,10);if(isNaN(n)||n<=0)this.showMessage("Пожалуйста, введите корректный ID пользователя.","danger");else{this.userId=n;try{this.socket=io("https://dev.simatap.ru",{transports:["websocket"],secure:!0,rejectUnauthorized:!1}),this.socket.on("connect",(function(){console.log("Подключено к серверу Socket.IO"),e.showMessage("Подключено к серверу.","success"),e.socket.emit("register",{userId:e.userId}),console.log('Отправлено событие "register" с userId: '+e.userId)})),this.socket.on("disconnect",(function(){console.log("Отключено от сервера Socket.IO"),e.showMessage("Отключено от сервера.","danger"),e.showUserForm(!0),e.showUserInfo(!1)})),this.socket.on("energyUpdated",(function(s){e.updateEnergy(s.energy_left)})),this.socket.on("coinsUpdated",(function(s){var n=Math.round(s.coins);e.coinsLabel.string=""+n})),this.socket.on("tapError",(function(s){e.showMessage(s.message,"warning")})),this.socket.on("registrationError",(function(s){e.showMessage(s.message,"danger"),e.showUserForm(!0),e.showUserInfo(!1)})),this.socket.on("connect_error",(function(s){console.error("Ошибка подключения к Socket.IO:",s),e.showMessage("Ошибка подключения к серверу.","danger")}))}catch(e){console.error("Ошибка при инициализации Socket.IO:",e),this.showMessage("Ошибка подключения к серверу.","danger")}this.showUserForm(!1),this.showUserInfo(!0),this.showMessage("Вы успешно подключились.","success")}},r.onTap=function(){this.userId?this.socket&&this.socket.connected?(this.socket.emit("tap",{userId:this.userId}),console.log('Отправлено событие "tap"'),this.showMessage("Тап отправлен!","info")):(this.showMessage("Соединение с сервером отсутствует.","danger"),console.warn("Соединение с сервером отсутствует.")):this.showMessage("Пользователь не подключен.","danger")},r.showMessage=function(e,s){if(void 0===s&&(s="info"),this.messagesLabel)switch(this.messagesLabel.string=e,s){case"success":this.messagesLabel.node.color=new g(0,255,0);break;case"danger":this.messagesLabel.node.color=new g(255,0,0);break;case"warning":this.messagesLabel.node.color=new g(255,165,0);break;default:this.messagesLabel.node.color=new g(255,255,255)}else console.warn("messagesLabel не установлен.")},r.showUserForm=function(e){this.userIdInput&&this.connectButton?(this.userIdInput.node.active=e,this.connectButton.node.active=e):console.warn("userIdInput или connectButton не установлены.")},r.showUserInfo=function(e){this.coinsLabel&&this.energyProgressBar&&this.energyValueLabel?(this.coinsLabel.node.active=e,this.energyProgressBar.node.active=e,this.energyValueLabel.node.active=e):console.warn("coinsLabel, energyProgressBar или energyValueLabel не установлены.")},r.updateEnergy=function(e){var s=(e=Math.max(0,Math.min(this.maxEnergy,e)))/this.maxEnergy;this.energyProgressBar.progress=s,this.energyValueLabel.string=e+"/"+this.maxEnergy},s}(h)).prototype,"userIdInput",[b],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),B=s(L.prototype,"connectButton",[p],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),M=s(L.prototype,"coinsLabel",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),v=s(L.prototype,"energyProgressBar",[y],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),P=s(L.prototype,"energyValueLabel",[w],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),U=s(L.prototype,"messagesLabel",[I],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),m=L))||m));r._RF.pop()}}}));

System.register("chunks:///_virtual/SpineController.ts.ts",["./rollupPluginModLoBabelHelpers.js","cc","./SocketManager.ts"],(function(n){var e,t,i,o,r,s,a,l,c,p,u;return{setters:[function(n){e=n.applyDecoratedDescriptor,t=n.inheritsLoose,i=n.initializerDefineProperty,o=n.assertThisInitialized},function(n){r=n.cclegacy,s=n._decorator,a=n.sp,l=n.UITransform,c=n.Node,p=n.Component},function(n){u=n.SocketManager}],execute:function(){var h,f,g,d,m,C,S;r._RF.push({},"7af28zZEkNKYY1uSBPGocx/","SpineController.ts",void 0);var k=s.ccclass,y=s.property;n("SpineController",(h=k("SpineController"),f=y(a.Skeleton),g=y(u),h((C=e((m=function(n){function e(){for(var e,t=arguments.length,r=new Array(t),s=0;s<t;s++)r[s]=arguments[s];return e=n.call.apply(n,[this].concat(r))||this,i(e,"spine",C,o(e)),i(e,"socketManager",S,o(e)),e}t(e,n);var r=e.prototype;return r.onLoad=function(){var n=this.getComponent(l);n||(n=this.addComponent(l)),n.setContentSize(1897.88,2903.94),n.setAnchorPoint(.553265,.004952),this.node.on(c.EventType.TOUCH_END,this.onSpineClicked,this),this.spine?(this.spine.setAnimation(0,"Основная",!0),this.spine.setCompleteListener(this.onAnimationComplete.bind(this))):console.warn("Spine компонент не установлен в SpineController.")},r.onSpineClicked=function(n){console.log("Spine animation clicked"),this.spine&&(this.spine.setAnimation(1,"Нажатие",!1),this.spine.addAnimation(1,"Основная",!0,0)),this.socketManager?(console.log("Calling socketManager.onTap()"),this.socketManager.onTap()):console.warn("SocketManager не установлен в SpineController.")},r.onAnimationComplete=function(n){n&&1===n.trackIndex&&this.spine.setAnimation(1,"Основная",!0)},e}(p)).prototype,"spine",[f],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),S=e(m.prototype,"socketManager",[g],{configurable:!0,enumerable:!0,writable:!0,initializer:function(){return null}}),d=m))||d));r._RF.pop()}}}));

(function(r) {
  r('virtual:///prerequisite-imports/main', 'chunks:///_virtual/main'); 
})(function(mid, cid) {
    System.register(mid, [cid], function (_export, _context) {
    return {
        setters: [function(_m) {
            var _exportObj = {};

            for (var _key in _m) {
              if (_key !== "default" && _key !== "__esModule") _exportObj[_key] = _m[_key];
            }
      
            _export(_exportObj);
        }],
        execute: function () { }
    };
    });
});